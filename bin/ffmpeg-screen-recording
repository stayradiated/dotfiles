#!/usr/bin/env zsh

set -euo pipefail

INPUT="${1}"
BITRATE="${2:-500k}"

PRESET="fast"
TUNE="animation"

# ffmpeg -y -i "${INPUT}" -preset "${PRESET}" -tune "${TUNE}" -c:v libx264 -b:v "${BITRATE}" -pass 1 -an -f null /dev/null
# ffmpeg -y -i "${INPUT}" -preset "${PRESET}" -tune "${TUNE}" -c:v libx264 -b:v "${BITRATE}" -pass 2 -c:a aac -b:a 128k "${INPUT}.mp4"

ffmpeg -y -i "${INPUT}" -preset "${PRESET}" -tune "${TUNE}" -c:v libx264 -b:v "${BITRATE}" -profile:v main -c:a aac -b:a 128k "${INPUT}.mp4"
