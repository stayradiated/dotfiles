#!/usr/bin/env bash

# POMO_STATUS=$(pomo status --stream project)
# PROJECT=$(echo "${POMO_STATUS}" | jq -r .labels[0])
# ELAPSED=$(echo "${POMO_STATUS}" | jq -r .elapsed)
# TOTAL=$(pomo summary --stream project --label "${PROJECT}" | jq -r .duration)

BATTERY=$(acpi -b | grep -v unavailable | tail -n 1 | rg -o '\w+, \d+%')
BATTERY=$(echo "${BATTERY}" | sed 's/Discharging,\s*/▼/')
BATTERY=$(echo "${BATTERY}" | sed 's/Charging,\s*/▲/')
BATTERY=$(echo "${BATTERY}" | sed 's/Full,\s*//')

DATE=$(date +"%Y.%m.%d")
TIME=$(date +"%H:%M")

VOLUME=$(awk -F"[][]" '/Mono:/ { print $2 }' <(amixer sget Master))

PROFILE=$(cat /sys/firmware/acpi/platform_profile | head --bytes 1 | tr '[:lower:]' '[:upper:]')

echo "${PROFILE} ${TOTAL} ${PROJECT} ${ELAPSED} • ${BATTERY} • ${DATE} ${TIME} • ${VOLUME}"
