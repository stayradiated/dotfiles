#!/usr/bin/env zsh

local regex_ssh='ssh_\w+_[A-z0-9!@#$%^&*-=_+]{45,50}'
local regex_exports=';export \w+='

cd /home/admin/dotfiles/apps/zsh/state/

# show lines which are being removed
rg "${regex_ssh}" ./history.enc
rg "${regex_exports}" ./history.enc

# remove lines
< ./history.enc \
| rg -v "${regex_exports}" \
| rg -v "${regex_ssh}" \
> ./history.bak.enc

mv ./history.bak.enc ./history.enc
